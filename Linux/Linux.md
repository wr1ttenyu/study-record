# Linux

## 1.Linux的目录结构

Linux是树状的目录结构，只有一个根目录'/'。

记住一句经典的话 :

#####  在Linux世界里，一切皆文件。

### 1.1 Linux的具体目录结构 

`/bin [重点] (/usr/bin 、 /usr/local/bin)`                                                                                                             • 是Binary的缩写, 这个目录存放着最经常使用的命令

`/sbin (/usr/sbin 、 /usr/local/sbin)`                                                                                                                                   • s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序 

` /home [重点]`
• 存放普通用户的主目录，在Linux中每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。

 `/root [重点]`
• 该目录为系统管理员，也称作超级权限者的用户主目录。 

`/lib`
• 系统开机所需要最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。

`/lost+found`
• 这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。

`/etc [重点]`
• 所有的系统管理所需要的配置文件和子目录 my.conf

`/usr [重点]`
• 这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与windows下的program files目录。 

`/proc`
• 这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统信息。

`/boot [重点]`
• 存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件

`/srv`
• service缩写，该目录存放一些服务启动之后需要提取的数据。

`/sys`
• 这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统

`/tmp`
• 这个目录是用来存放一些临时文件的。 

`/dev`
• 类似于windows的设备管理器，把所有的硬件用文件的形式存储。

`/media [重点]`
• linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后， linux会把识别的设备挂载到这个目录下。

`/mnt [重点]`
• 系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在/mnt/上，然后进入该目录就可以查看里的内容了。

`/selinux [security-enhanced linux]`
• SELinux是一种安全子系统,它能控制程序只能访问特定文件。

`/var [重点]`
• 这个目录中存放着在不断扩充着的东西，习惯将经常被修改的目录放在这个目录下。包括各种日志文件。

`/opt`
• 这是给主机额外安装软件所摆放的目录。如安装ORACLE数据库就可放到该目录下。默认为空。

`/usr/local [重点]`
• 这是另一个给主机额外安装软件所安装的目录。一般是通过编译源码方式安装的程序。

## 2. vi 和 vim

所有的 Linux 系统都会内建 vi 文本编辑器。
Vim 具有程序编辑的能力，可以看做是Vi的增强版本，可以主动的以字体颜色辨别
语法的正确性，方便程序设计。代码补完、编译及错误跳转等方便编程的功能特别
丰富，在程序员中被广泛使用 。

###2.1 vi和vim常用的三种模式

- 正常模式:

  以 vim 打开一个档案就直接进入一般模式了(这是默认的模式)。在这个模式中， 你可以使用『上下左右』 按键来移动光标，你可以使用『删除字符』 或『删除整行』 来处理档案内容，也可以使用『复制、贴上』 来处理你的文件数据。

- 插入模式:

  按下i, I, o, O, a, A, r, R等任何一个字母之后才会进入编辑模式, 一般来说按i即可.

- 命令行模式

  在这个模式当中， 可以提供你相关指令，完成读取、存盘、替换、离开 vim 、显示行号等的动作则是在此模式中达成的！ 

- vi和vim的模式切换


![vi和vim的模式切换](img\vi和vim的模式切换.png)

- vi和vim有很多快捷键，上网百度即可

  小练习：

  1) 拷贝当前行 yy , 拷贝当前行向下的5行 5yy，并粘贴。
  2) 删除当前行 dd , 删除当前行向下的5行 5dd
  3) 在文件中查找某个单词 [命令行下 /关键字  ， 回车 查找 , 输入 n 就是查找下一个 ]
  4) 设置文件的行号，取消文件的行号.[命令行下 : set nu 和 :set nonu]
  5) 编辑 /etc/profile 文件，使用快捷键到底文档的最末行[G]和最首行[gg]
  6) 在一个文件中输入 "hello" ,然后又撤销这个动作 u
  7) 编辑 /etc/profile 文件，并将光标移动到 20行 shift+g 

  ​



##3. 关机&重启命令&用户登录和注销  

### 3.1 关机&重启命令 

- 基本介绍:

| 指令              | 作用                 |
| --------------- | ------------------ |
| shutdown –h now | 立该进行关机             |
| shudown  –h 1   | "hello, 1 分钟后会关机了" |
| shutdown –r now | 现在重新启动计算机          |
| halt            | 关机，作用和上面一样.        |
| reboot          | 现在重新启动计算机          |
| sync            | 把内存的数据同步到磁盘        |

- 注意细节:

**不管是重启系统还是关闭系统，首先要运行sync命令，把内存中的数据写到磁盘中** 

### 3.2 用户登录和注销 

- 基本介绍:

  1) 登录时尽量少用root帐号登录，因为它是系统管理员，最大的权限，避免操作失误。可
  以利用普通用户登录，登录后再用” su - 用户名’命令来切换成系统管理员身份.
  2) 在提示符下输入 logout 即可注销用户

- 使用细节:

  1) logout 注销指令在图形运行级别无效，在 运行级别 3下有效.
  2) 运行级别这个概念，后面给大家介绍 



## 4. 用户管理    

1. 基本介绍 

  Linux系统是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须首先向 系统管理员申请一个账号，然后以这个账号的身份进入系统。 

2. 添加用户 

- 基本语法 

  useradd  用户名 

- 应用案例 

  1)案例1:添加一个用户 xiaoming 

- 细节说明 

  1) 当创建用户成功后，会自动的创建和用户同名的家目录 

  2) 也可以通过 useradd -d 指定目录 新的用户名，给新创建的用户指定家目录

3. 指定/修改密码

- 基本语法 

  passwd 用户名 

- 应用案例 

  1) 给xiaoming 指定密码

4. 删除用户 

- 基本语法 

  userdel 用户名 

- 应用案例 

  1) 删除用户xiaoming，但是要保留家目录  userdel 【用户名】

  2) 删除用户以及用户主目录   userdel -r 【用户名】

- 细节说明

  1) 是否保留家目录的讨论    

  在删除用户时，一般会保留家目录，保存用户的工作数据。

5. 查询用户信息

- 基本语法

  id 用户名

6. 切换用户

- 介绍 

  在操作Linux中，如果当前用户的权限不够，可以通过 su - 指令，切换到高权限用户，比如root    

- 基本语法 

  su – 切换用户名 

  **扩展**：

  su 是切换到其他用户，但是不切换环境变量（比如说那些你用export命令查看一下，就知道两个命令的区别了）

  su - 是完整的切换到一个用户环境

- 细节说明 

  1) 从权限高的用户切换到权限低的用户，不需要输入密码，反之需要。 

  2) 当需要返回到原来用户时，使用exit指令 

7. 查看当前用户/登录用户 

- 基本语法

  whoami/ who am I

  

#5. 用户组

- 介绍 

  类似于角色，系统可以对有共性的多个用户进行统一的管理。 

1. 新增组

- 指令  

  groupadd 组名    

2. 删除组 

- 指令(基本语法) 

  groupdel 组名 

3. 增加用户时直接加上组 

- 指令(基本语法) 

  useradd –g  用户组 用户名

4. 修改用户的组 

- 指令(基本语法) 

  usermod –g 用户组 用户名    

5. 用户和组的相关文件 

   /etc/passwd 文件 

   用户（user）的配置文件，记录用户的各种信息 

   每行的含义： 用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell

   ![etc-password解析](.\img\etc-password解析.png)

   /etc/shadow 文件 

   口令的配置文件 

   每行的含义： 登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志    

   /etc/group 文件 

   组(group)的配置文件，记录Linux包含的组的信息 

   每行含义： 组名:口令:组标识号:组内用户列表

   ![etc-group解析](.\img\etc-group解析.png)    





# 6. Linux实操篇 实用指令

## 6.1 运行级别

- 指定运行级别 

  基本介绍: 

  运行级别说明： 

  0 ：关机 

  1 ：单用户【找回丢失密码】 

  2：多用户状态没有网络服务 

  3：多用户状态有网络服务 

  4：系统未使用保留给用户 

  5：图形界面 

  6：系统重启 

  常用运行级别是3和5 ，要修改默认的运行级别可改文件 

  /etc/inittab的id:5:initdefault:这一行中的数字 

  命令： init [012356]    

- 运行级别的示意图：

![运行级别](img\运行级别.png)

- 面试题

  如何找回 root 密码，如果我们不小心，忘记 root  密码，怎么找回。

  思路： 进入到 单用户模式，然后修改 root 密码。因为进入单用户模式，root 不需要密码就可以登录。

  开机->在引导时输入 回车键-> 看到一个界面输入 e -->  看到一个新的界面，选中第二行（编辑内核）在输入  e -->  在这行最后输入1 ,再输入 回车键 -->再次输入 b ,这时就会进入到单用户模式。

  这时，我们就进入到单用户模式，使用 passwd  指令来修改 root  密码。



## 6.2 帮助指令

- 介绍

  当我们对某个指令不熟悉时，我们可以使用 Linux 提供的帮助指令来了解这个指令的使用方法。

- man 获得帮助信息

1. 基本语法

   man [命令或配置文件]（功能描述：获得帮助信息）

- help 指令

1. 基本语法

   help 命令 （功能描述：获得 shell 内置命令的帮助信息） 

   

## 6.3 文件目录类

- pwd 指令

1. 基本语法

   pwd      (功能描述：显示当前工作目录的绝对路径)

------

- ls 指令

1. 基本语法

   ls  [选 项]

2. 常用选项

   -a ：显示当前目录所有的文件和目录，包括隐藏的、

------

- cd 指令

1. 基本语法

   cd    [参数] (功能描述：切换到指定目录)

2. 常用参数

   cd ~ 或者 cd ：回到自己的家目录

   cd .. 回到当前目录的上一级目录

------

- mkdir 指令

  mkdir 指令用于创建目录(make directory)

1. 基本语法

   mkdir    [选项]    要创建的目录

2. 常用选项

   -p ：创建多级目录 (不加-p 创建多级目录时，必须存在父目录，否则不能创建)

------

- rmdir 指令

  rmdir 指令删除空目录

1. 基本语法

   rmdir    [选项]    要删除的空目录

2. 使用细节

   rmdir 删除的是空目录，如果目录下有内容时无法删除的。

   如果需要删除非空目录，需要使用 rm -rf 要删除的目录。

------

- touch 指令

  touch 指令创建空文件

1. 基本语法

   touch 文件名称(可以一次创建多个文件)

------

- cp 指令[重要]

  cp 指令拷贝文件到指定目录

1. 基本语法

   cp [选项] source dest

   \cp [选项] source dest  （相同文件强制覆盖，不询问）

2. 常用选项

   -r ：递归复制整个文件夹

------

- rm 指令

  rm 指令移除【删除】文件或目录

1. 基本语法

   rm    [选项]    要删除的文件或目录

2. 常用选项

   -r ：递归删除整个文件夹

   -f ： 强制删除不提示

------

- mv 指令

  mv 移动文件与目录或重命名

1. 基本语法

   mv oldNameFile newNameFile   (功能描述：重命名) 

   mv /temp/movefile /targetFolder (功能描述：移动文件)

------
- cat 指令

  cat 查看文件内容，是以只读的方式打开。

1. 基本语法

   cat    [选项] 要查看的文件

2. 常用选项

   -n ：显示行号

3. 使用细节

   cat 只能浏览文件，而不能修改文件，为了浏览方便，一般会带上                                                                                   管道命令 | more

   cat 文件名 | more [分页浏览]

4. 快捷键

![more快捷键](img\more快捷键.png)



------

- less 指令

  用来分屏查看文件内容，它的功能与 more 指令类似，但是比 more 指令更加强大，支持各种显示终端。less 指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。

1. 基本语法

   less 要查看的文件

2. 快捷键

![less快捷键](img\less快捷键.png)

------

- \> 指令 和 >>  指令

1. 介绍

   \> 指 令 和 >> 指 令
   \> 输出重定向 : 会将原来的文件的内容覆盖

   \> > 追加： 不会覆盖原来文件的内容，而是追加到文件的尾部。

2. 基本语法

   1) ls -l > 文件（功能描述：列表的内容写入文件 a.txt 中（覆盖写））

   2)  ls -al >>文件 （功能描述：列表的内容追加到文件 aa.txt 的末尾）

   3)  cat 文件 1 > 文件 2 （功能描述：将文件 1 的内容覆盖到文件 2）  

------

- echo 指令

  echo 输出内容到控制台。

1. 基本语法

   echo [选项]  \[输出内容]

2. 应用实例

   案例: 使用 echo 指令输出环境变量,输出当前的环境路径。

   echo $PATH

------

- head 指令 

  head 用于显示文件的开头部分内容，默认情况下 head 指令显示文件的前 10 行内容

1. 基本语法

   head  文件   (功能描述：查看文件头 10 行内容)

   head  -n  5  文件   (功能描述：查看文件头 5 行内容，5 可以是任意行数)

2. 应用实例

   案例: 查看/etc/profile 的前面 5 行代码

------

- tail 指令

  tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的后 10 行内容。

1. 基本语法

   tail  文件 （功能描述：查看文件后 10 行内容） 

   tail  -n  5  文件   (功能描述：查看文件后 5 行内容，5 可以是任意行数 )

   tail  -f  文件   (功能描述：实时追踪该文档的所有更新，工作经常使用 )

------

- In 指令

  软链接也叫符号链接，类似于 windows 里的快捷方式，主要存放了链接其他文件的路径

1. 基本语法

   ln -s [原文件或目录] \[软链接名] 

   （功能描述：给原文件创建一个软链接）

------

- history 指令

   查看已经执行过历史命令,也可以执行历史指令

1. 基本语法

   history   （功能描述：查看已经执行过历史命令）

2. 使用细节

   1）指定显示历史指令的个数

   ![history  指定显示历史指令的个数](..\Linux\img\history  指定显示历史指令的个数.png)

   2）执行历史指令

   ![history 执行之前的命令](..\Linux\img\history 执行之前的命令.png)



## 6.4 时间日期类

- date 指令

  显示当前日期 

1. 基本语法

   1) date	（功能描述：显示当前时间）

   2) date +%Y（功能描述：显示当前年份）

   3) date +%m （功能描述：显示当前月份）

   4) date +%d	（功能描述：显示当前是哪一天） 

   5) date "+%Y-%m-%d %H:%M:%S"（功能描述：显示年月日时分秒） 

------

- date 指令-设置日期 

1. 基本语法

   date  -s   字符串时间(yyyy-MM-dd HH:mm:ss)

------

- 查看日历指令

  • 基本语法

  cal  [选项]  （功能描述：不加选项，显示本月日历）



## 6.5 索查找类

- find 指令

  find 指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端。

- 基本语法

  find  [搜索范围]  \[选项]

- 选项说明

  ![find 选项说明](..\Linux\img\find 选项说明.jpg)

- 应用实例 

  查找整个 linux 系统下大于 20m 的文件（+n  大于  -n 小于  n 等于 ）

  ![find 指定文件大小](..\Linux\img\find 指定文件大小.gif) 

------
- locate 指令

  locate 指令可以快速定位文件路径。locate 指令利用事先建立的系统中所有文件名称及路径的

  locate 数据库实现快速定位给定的文件。Locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新 locate 时刻。

- 基本语法

  locate 搜索文件

- 特别说明

  由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建 locate 数据库。

- 应用实例

![locate](..\Linux\img\locate.jpg)

------

- grep 指令和 管道符号 |

  grep 过滤查找 ， 管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理。

- 基本语法

  grep [选项] 查找内容 源文件

- 常用选项

   ![grep选项](..\Linux\img\grep选项.png)

- 应用实例

  案例 1: 请在  hello.txt  文件中，查找  "yes"    所在行，并且显示行号

  ![grep实例](..\Linux\img\grep实例.png)



## 6.6 压缩和解压类

- 9.5.1 gzip/gunzip 指令

   gzip 用于压缩文件， gunzip  用于解压的

- 基本语法

  gzip  文件  （功能描述：压缩文件，只能将文件压缩为*.gz 文件, 不保留源文件）

  gunzip  文件.gz  （功能描述：解压缩文件命令）

- 细节说明

   当我们使用 gzip  对文件进行压缩后，不会保留原来的文件。

------

- zip/unzip 指令

  zip 用于压缩文件， unzip 用于解压的，这个在项目打包发布中很有用的

-  基本语法

   zip   [选项]  XXX.zip    将要压缩的内容（功能描述：压缩文件和目录的命令）

   unzip  [选项]  XXX.zip （功能描述：解压缩文件）

-  zip 常用选项

   -r：递归压缩，即压缩目录

-  unzip 的常用选项

   -d <目录> ：指定解压后文件的存放目录

------

- tar 指令

  tar 指令 是打包指令，最后打包后的文件是 .tar.gz 的文件。

- 基本语法

  tar  [选项]  XXX.tar.gz   打包的内容    (功能描述：打包目录，压缩后的文件格式.tar.gz)

- 选项说明

  ![tar 选项](..\Linux\img\tar 选项.jpg)





# 7. 实操篇 组管理和权限管理 

## 7.1  Linux 组基本介绍

 	在 linux 中的每个用户必须属于一个组，不能独立于组外。在 linux 中每个文件有所有者、所在组、其它组的概念。

​	1)   所有者

​	2)   所在组

​	3)   其它组

​	4）改变用户所在的组

------

- 文件/目录 所有者 

![创建用户 指定组](..\Linux\img\创建用户 指定组.png)



![创建文件并查看](..\Linux\img\创建文件并查看.png)

------

- 修改文件所有者

   指令 ：chown  用户名  文件名 (不会修改文件的所有组)

- 组的创建

  基本指令 ：groupadd  组名

------

- 文件/目录 所在组

  当某个用户创建了一个文件后，默认这个文件的所在组就是该用户所在的组。

- 查看文件/目录所在组

   基本指令 ：ls –ahl

- 修改文件所在的组

   基本指令 ：chgrp  组名  文件名

- 其它组

   除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组。

------

## 7.2 改变用户所在组

 	在添加用户时，可以指定将该用户添加到哪个组中，同样的用 root 的管理权限可以改变某个用户所在的组。 

- 改变用户所在组

  1)  usermod   –g   组名   用户名

  

## 7.3 权限的基本介绍 

 	ls    -l 中显示的内容如下：

​	**-rwxrw-r--** 1 root root 1213 Feb 2 09:39 abc

​	0-9 位说明

​	1) 第 0 位确定文件类型(d, - , l , c , b)

​	2) 第 1-3 位确定所有者（该文件的所有者）拥有该文件的权限。---User

​	3) 第 4-6 位确定所属组（同用户组的）拥有该文件的权限，---Group

​	4) 第 7-9 位确定其他用户拥有该文件的权限 ---Other

![文件权限详解](..\Linux\img\文件权限详解.png)



## 7.4 rwx 权限详解

- rwx 作用到文件

  1)  [ r ] 代表可读(read):  可以读取，查看

  2)  [ w ] 代表可写(write): 可以修改，但是不代表可以删除该文件，删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件

  3）[ x ] 代表可执行(execute)：可以被执行 

- rwx 作用到目录
  1)  [ r ] 代表可读(read):  可以读取，ls 查看目录内容

  2)  [ w ] 代表可写(write):  可以修改,目录内创建+删除+重命名目录

  3）[ x ] 代表可执行(execute): 可以进入该目录

- 文件及目录权限实际案例

  ls  -l  中显示的内容如下：(记住)

  -rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc

  10 个字符确定不同用户能对文件干什么

  第一个字符代表文件类型： 文件 (-),目录(d),链接(l)

  其余字符每 3 个一组(rwx) 读(r) 写(w) 执行(x) 

  第一组 rwx : 文件拥有者的权限是读、写和执行

  第二组 rw- :  与文件拥有者同一组的用户的权限是读、写但不能执行

  第三组 r-- :   不与文件拥有者同组的其他用户的权限是读不能写和执行可用数

  字表示为: r=4,w=2,x=1  因此 rwx=4+2+1=7

  1	文件：硬连接数或		目录：子目录数
  root	用户
  root	组
  1213	文件大小(字节)，如果是文件夹，显示 4096 字节
  Feb 2 09:39	最后修改日期
  abc	文件名

------

- 修改权限-chmod

1. 基本说明：

   通过 chmod 指令，可以修改文件或者目录的权限

2. 第一种方式：+ 、-、=  变更权限

   u:所有者   g:所有组   o:其他人   a:所有人(u、g、o 的总和)

   1)  chmod      u=rwx,g=rx,o=x      文件目录名

   2)  chmod      o+w        文件目录名

   3)  chmod      a-x        文件目录名

3. 第二种方式：通过数字变更权限

   规则：r=4 w=2 x=1  , rwx=4+2+1=7 

   chmod u=rwx,g=rx,o=x   文件目录名

   相当于  chmod 751  文件目录名

------

- 修改文件所有者-chown

1. 基本介绍

   chown  newowner    file    改变文件的所有者

   chown  newowner:newgroup   file    改变用户的所有者和所有组

   -R    如果是目录 则使其下所有子文件或目录递归生效

------

- 修改文件所在组-chgrp

1. 基本介绍

	chgrp newgroup file   改变文件的所有组



# 8. 实操篇 crond 任务调度 

## 8.1 原理示意图 

![定时任务概述](..\Linux\img\定时任务概述.png)

## 8.2 概述

任务调度：是指系统在某个时间执行的特定的命令或程序。

任务调度分类：

1. 系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等
2. 个别用户工作：个别用户可能希望执行某些程序，比如对 mysql 数据库的备份。

------
- 基本语法

  crontab	 [选项]

- 常用选项

![crontab选项](C:\Users\wr1ttenyu\学习\study-record\Linux\img\crontab选项.png)

------

- 快速入门

  任务的要求

  设置任务调度文件：/etc/crontab

  设置个人任务调度。执行 crontab –e 命令。接着输入任务到调度文件

  如：*/1 * * * *  ls  –l   /etc/  >>  /tmp/to.txt

  意思说每小时的每分钟执行 ls  –l  /etc/  >>  /tmp/to.txt  命令

- 细节说明

  ![crontab--时间选项说明1](..\Linux\img\crontab--时间选项说明1.png)![crontab--时间选项说明2](..\Linux\img\crontab--时间选项说明2.png)



## 8.3 任务调度的几个应用实例

- 案例 1：每隔 1 分钟，就将当前的日期信息，追加到 /tmp/mydate  文件

  中

  1)     先编写一个文件  /home/mytask1.sh  date >> /tmp/mydate

  2)     给 mytask1.sh  一个可以执行权限

  ​	chmod 744 /home/mytask1.sh

  3)     crontab -e

  4)     */1 * * * *    /home/mytask1.sh

  5)     成功	

- 案例 2：每隔 1 分钟， 将当前日期和日历都追加到 /home/mycal  文件中

  1)   先编写一个文件   /home/mytask2.sh   date >> /tmp/mycal cal >> /tmp/mycal

  2)  给 mytask1.sh 一个可以执行权限

  ​	chmod 744 /home/mytask2.sh

  3)  crontab -e

  4)  */1 * * * *    /home/mytask2.sh

  5)   成功

- crond 相关指令:

  1)   conrtab –r：终止任务调度。

  2)   crontab –l：列出当前有那些任务调度

  3)   service crond restart     [重启任务调度]





# 9.  实操篇 Linux 磁盘分区、挂载

## 9.1 分区基础知识

### 9.1.1  分区的方式：

1).  mbr 分区:

1. 最多支持四个主分区
2. 系统只能安装在主分区
3. 扩展分区要占一个主分区
4. MBR 最大只支持 2TB，但拥有最好的兼容性

 2). gtp 分区:

1. 支持无限多个主分区（但操作系统可能限制，比如 windows 下最多 128 个分区）
2. 最大支持 18EB 的大容量（1EB=1024 PB，1PB=1024 TB  ）



### 9.1.2  windows 下的磁盘分区

![windows下的磁盘分区](..\Linux\img\windows下的磁盘分区.png)

## 9.2 Linux 分区

###9.2.1 原理介绍
1. Linux 来说无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构, Linux 中每个分区都是用来组成整个文件系统的一部分。
2. Linux 采用了一种叫“载入”的处理方法，它的整个文件系统中包含了一整套的文件和目录， 且将一个分区和一个目录联系起来。这时要载入的一个分区将使它的存储空间在一个目录下获得。
3. 示意图

![Linux分区原理示意图](..\Linux\img\Linux分区原理示意图.png)

### 9.2.3  硬盘说明

- Linux 硬盘分 IDE 硬盘和 SCSI 硬盘，目前基本上是 SCSI 硬盘
- 对于 IDE 硬盘，驱动器标识符为“hdx~”,其中“hd”表明分区所在设备的类型，这里是指 IDE 硬盘了。“x”为盘号（a 为基本盘，b 为基本从属盘，c 为辅助主盘，d 为辅助从属盘）,“~”代表分区，前四个分区用数字 1 到 4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。例，hda3 表示为第一个 IDE 硬盘上的第三个主分区或扩展分区,hdb2 表示为第二个 IDE 硬盘上的第二个主分区或扩展分区。
- 对于 SCSI 硬盘则标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，其余则和 IDE 硬盘的表示方法一样。
- 使用 lsblk 指令查看当前系统的分区情况

![linux分区](..\Linux\img\linux分区.png)

![lsblk指令查看分区](..\Linux\img\lsblk指令查看分区.png)





### 9.2.4  如何增加一块硬盘

1. 虚拟机添加硬盘

2. 分区       fdisk /dev/sdb

3. 格式化   mkfs    -t ext4    /dev/sdb1

4. 挂载       先创建一个  /home/newdisk , 挂 载  mount   /dev/sdb1   /home/newdisk

5. 设置可以自动挂载(永久挂载，当你重启系统，仍然可以挂载到 /home/newdisk) 。

   vim  /etc/fstab

/dev/sdb1                    /home/newdisk                      ext4                                    defaults                                  0 0







## 9.3 增加硬盘具体的操作步骤整理

### 9.3.1 虚拟机增加硬盘步骤 1

​	在【虚拟机】菜单中，选择【设置】，然后设备列表里添加硬盘，然后一路【下一步】，中间只有选择磁盘大小的地方需要修改，至到完成。然后重启系统（才能识别）！ 

### 9.3.2 虚拟机增加硬盘步骤 2

分区命令   fdisk   /dev/sdb

开始对/sdb 分区

• m      显示命令列表

• p       显示磁盘分区 同 fdisk    –l

• n       新增分区

• d       删除分区

• w      写入并退出

说明： 开始分区后输入 n，新增分区，然后选择 p ，分区类型为主分区。两次回车默认剩余全

部空间。最后输入 w 写入分区并退出，若不保存退出输入 q。

![磁盘分区](..\Linux\img\磁盘分区.png)

### 9.3.3 虚拟机增加硬盘步骤 3

格式化磁盘

分区命令 : mkfs  -t  ext4  /dev/sdb1

其中 ext4 是分区类型

### 9.3.4 虚拟机增加硬盘步骤 4

挂载: 将一个分区与一个目录联系起来，

• mount   设备名称   挂载目录

• 例如：  mount   /dev/sdb1  /newdisk

• umount   设备名称  或者   挂载目录

• 例如：  umount  /dev/sdb1  或者  umount  /newdisk

### 9.3.5 虚拟机增加硬盘步骤 5

![永久挂载](..\Linux\img\永久挂载.jpg)

永久挂载 :  通过修改 /etc/fstab 

实现挂载添加完成后  执行 mount –a 即刻生效



## 9.4 磁盘情况查询

### 9.4.1 查询系统整体磁盘使用情况

基本语法

df -h

应用实例

查询系统整体磁盘使用情况

![linux磁盘使用情况查看](..\Linux\img\linux磁盘使用情况查看.gif) 

### 9.4.2 查询指定目录的磁盘占用情况

•基本语法

du -h    /目录

查询指定目录的磁盘占用情况，默认为当前目录

-s 指定目录占用大小汇总

-h 带计量单位

-a 含文件

--max-depth=1    子目录深度

-c 列出明细的同时，增加汇总值



- 应用实例 

  1）查询  /opt 目录的磁盘占用情况，深度为 1

![目录的磁盘占用情况](..\Linux\img\目录的磁盘占用情况.png)

​	2）统计/home 文件夹下文件的个数 

![统计home文件夹下文件的个数](..\Linux\img\统计home文件夹下文件的个数.png)

​	3）统计/home 文件夹下文件的个数，包括子文件夹里的

![递归统计home文件夹下文件的个数](..\Linux\img\递归统计home文件夹下文件的个数.png)

​	4)  以树状结构显示目录![树状结构显示目录](..\Linux\img\树状结构显示目录.png)

## 10  linux 网络环境配置

说明 : 直 接 修 改 配 置 文 件 来 指 定  IP, 并 可 以 连 接 到 外 网 ( 程 序 员 推 荐 ) ， 编 辑                 vi/etc/sysconfig/network-scripts/ifcfg-eth0

要求：将 ip 地址配置的静态的，ip 地址为 192.168.184.130

![linux网络配置](..\Linux\img\linux网络配置.png)

修改后，一定要 重启服务

service network restart   或者  reboot 重启系统

![linux网络配置文件说明](..\Linux\img\linux网络配置文件说明.png)



## 11 实操篇 进程管理

### 11.1  进程的基本介绍

- 在 LINUX 中，每个执行的程序（代码）都称为一个进程。每一个进程都分配一个 ID 号。
- 每一个进程，都会对应一个父进程，而这个父进程可以复制多个子进程。例如 www 服务器。
- 每个进程都可能以两种方式存在的。前台与后台，所谓前台进程就是用户目前的屏幕上可以进行操作的。后台进程则是实际在操作，但由于屏幕上无法看到的进程，通常使用后台方式执行。
- 一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才才结束。

###11.2 显示系统执行的进程 

- 查看进行使用的指令     

  ps   一般来说使用的参数是  ps -aux

  ![ps指令](img\ps指令.png)

![ps结果解析](img\ps结果解析.png)

### 11.3  ps 指令详解

- 指令：ps –aux|grep xxx

		• System V 展示风格

		• USER：用户名称
		
		• PID：进程号
		
		• %CPU：进程占用 CPU 的百分比
		
		• %MEM：进程占用物理内存的百分比
		
		• VSZ：进程占用的虚拟内存大小（单位：KB）
		
		• RSS：进程占用的物理内存大小（单位：KB）
		
		• TT：终端名称,缩写 .
		
		• STAT：进程状态，其中 S-睡眠，s-表示该进程是会话的先导进程，N-表示进程拥有比普通优先级更低的优先级，R-正在运行，D-短期等待，Z-僵死进程，T-被跟踪或者被停止等等
		
		• STARTED：进程的启动时间
		
		• TIME：CPU 时间，即进程使用 CPU 的总时间
		
		• COMMAND：启动进程所用的命令和参数，如果过长会被截断显示



- ps -ef 是以全格式显示当前所有的进程

  -e 显示所有进程

  -f 全格式

  • UID：用户 ID

  • PID：进程 ID

  • PPID：父进程 ID

  • C：CPU 用于计算执行优先级的因子。数值越大，表明进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明进程是 I/O 密集型运算，执行优先级会提高

  • STIME：进程启动的时间

  • TTY：完整的终端名称

  • TIME：CPU 时间

  • CMD：启动进程所用的命令和参数

  

## 12 终止进程 kill 和 killall

- 介绍:

  若是某个进程执行一半需要停止时，或是已消了很大的系统资源时，此时可以考虑停止该进程。使用 kill 命令来完成此项任务.

- 基本语法：

  kill    [选项] 进程号（功能描述：通过进程号杀死进程）

  killall 进程名称（功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）

- 常用选项：

  -9 : 表示强迫进程立即停止

- 查看进程树 **pstree**

  pstree [选项] ,可以更加直观的来看进程信息

  - 常用选项：

    -p : 显示进程的 PID

    -u : 显示进程的所属用户



## 13 服务(Service)管理

###13.1 介绍

​	服务(service) 本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其它程序的请求，比如(mysql , sshd 防火墙等)，因此我们又称为守护进程，是 Linux 中非常重要的知识点。

​	service管理指令： service 服务名 [start | stop | restart | reload | status]    

​	在 CentOS7.0 后 不再使用 service ,而是 systemctl

​	【原理图】

![Linux服务介绍](img\Linux服务介绍.png)

- 细节讨论：

  1)  关闭或者启用防火墙后，立即生效。[telnet 测试  某个端口即可]

  2）service 改变服务状态 ：这种方式只是临时生效，当重启系统后，还是回归以前对服务的设置 

  ​      如果希望设置某个服务自启动或关闭永久生效，要使用 chkconfig 指令 

### 13.2      查看服务名:

- 方式 1：

  使用 setup -> 系统服务 就可以看到

- 方式 2:  

  /etc/init.d/服务名称

  

###13.3 Linux 系统有 7 种运行级别(runlevel)：

常用的是级别 3 和 5

• 运行级别 0：系统停机状态，系统默认运行级别不能设为 0，否则不能正常启动

• 运行级别 1：单用户工作状态，root 权限，用于系统维护，禁止远程登陆

• 运行级别 2：多用户状态(没有 NFS)，不支持网络

• 运行级别 3：完全的多用户状态(有 NFS)，登陆后进入控制台命令行模式

• 运行级别 4：系统未使用，保留

• 运行级别 5：X11 控制台，登陆后进入图形 GUI 模式

• 运行级别 6：系统正常关闭并重启，默认运行级别不能设为 6，否则不能正常启动



### 13.4 开机的流程说明                          
![linux启动流程](img\linux启动流程.jpg)

###13.5 chkconfig 指令介绍  

​	通过chkconfig 命令可以给每个服务的各个运行级别设置自启动/关闭

- 基本语法

  1)  查看服务    

  ​	chkconfig   --list | grep  xxx

  2)  根据服务名查看服务   

  ​	chkconfig    服务名      --list

  3)  根据服务名改变在某运行级别下面的自启动状态

  ​     	chkconfig   --level    5    服务名    on/off  

- 使用细节

  chkconfig 重新设置服务后自启动或关闭，需要重启机器 reboot 才能生效

## 14 动态监控进程

### 14.1 介绍：

 	top 与 ps 命令很相似。它们都用来显示正在执行的进程。Top 与 ps 最大的不同之处，在于 top 在执行一段时间可以更新正在运行的的进程。

### 14.2 基本语法：

​	top [选项]

- 选项说明

![top选项](img\top选项.png)

![top操作交互说明](img\top操作交互说明.png)

- top显示解析

![top显示解析](img\top显示解析.png)

- 使用细节

  top指令后

  u：然后输入“u”回车，再输入用户名，即可 查看指定用户的进程

  k：然后输入“k”回车，再输入要结束的进程 ID 号

  

### 14.3     查看系统网络情况 netstat(重要)

- 基本语法

  netstat [选项]

  netstat -anp

- 选项说明

  -an    按一定顺序排列输出

  -p    显示哪个进程在调用



# 10. 实操篇 RPM 和 YUM

## 10.1 rpm 包的管理

### 10.1.1   介绍：

​	一种用于互联网下载包的打包及安装工具，它包含在某些 Linux 分发版中。它生成具有.RPM 扩展名的文件。RPM 是 RedHat Package Manager（RedHat 软件包管理工具）的缩写，类似 windows 的setup.exe，这一文件格式名称虽然打上了 RedHat 的标志，但理念是通用的。

​	Linux 的分发版本都有采用（suse,redhat, centos  等等），可以算是公认的行业标准了。

- pm 包的简单查询指令：

  1. 查询已安装的 rpm 列表 rpm  –qa | grep xx

     请查询看一下，当前的 Linux 有没有安装 docker

     rpm -qa | grep docker

     ![rpm查询结果](img\rpm查询结果.png)



###10.1.2 rpm包的管理 

- rpm包的其它查询指令： 

  1. rpm -qa : 查询所安装的所有rpm软件包 

     rpm -qa | more 

     rpm -qa | grep X [rpm -qa | grep firefox] 

  2. rpm -q 软件包名 : 查询软件包是否安装 

     rpm -q firefox 

  3. rpm -qi 软件包名 : 查询软件包信息 

     rpm -qi file 

  4. rpm -ql 软件包名 : 查询软件包中的文件  **查询到软件安装到什么位置**

     rpm -ql firefox 

  5. rpm -qf 文件全路径名 : 查询文件所属的软件包 

     rpm -qf /etc/passwd rpm -qf /root/install.log      

### 10.1.3  卸载 rpm 包：

- 基本语法

  rpm  -e  RPM  包的名称

- 细节问题

  1)   如果其它软件包依赖于您要卸载的软件包，卸载时则会产生错误信息。如： $ rpm -e foo

  removing these packages would break dependencies:foo is needed by bar-1.0-1

  如果我们就是要删除 foo 这个 rpm 包，可以增加参数 --nodeps ,

  就可以强制删除，但是一般不推荐这样做，因为依赖于该软件包的程序可能无法运行

  如：$ rpm  -e  **--nodeps**  foo

  带上 **--nodeps**  就是强制删除

### 10.1.4      安装 rpm 包：

- 基本语法

  rpm  -ivh  RPM  包全路径名称

- 参数说明

  i = install 安 装

  v = verbose 提 示

  h = hash 进度条

## 10.2  yum

### 10.2.1  介绍：

​	Yum 是一个 [Shell ](https://baike.baidu.com/item/Shell)前端软件包管理器。

​	基于 [RPM ](https://baike.baidu.com/item/RPM)包管理，能够从指定的服务器自动下载 RPM 包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包。

​	使用 yum 的前提是可以联网。

### 10.2.2  yum 的基本指令

- 查询 yum 服务器是否有需要安装的软件

​	yum  list | grep  xx 软件列表

- 安装指定的 yum 包

  yum  install  xxx   下载安装 

 

 

 

 

# 11.  JavaEE 定制篇 搭建 JavaEE 环境

## 11.1  概述

### 11.1.1   示意图 

![javaEE环境示意图](img\javaEE环境示意图.png)

 

 ## 11.2    安装 JDK

### 	16.1.2  安装步骤

0)   先将软件通过 xftp5 上传到 /opt 下

1)   解压缩到 /opt

​                       ![img](file:///C:/Users/WR1TTE~1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.jpg)       

 

配置环境变量的配置文件 

vim    /etc/profile